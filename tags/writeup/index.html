<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>writeup | 0xNinja - My blog</title><meta name=keywords content><meta name=description content="I love to share ~~flags~~ knowledge, I write sometimes about CTF, challenges and other common subjects like Peano's arithmetic or Kerbal Space Program."><meta name=author content="0xNinja"><link rel=canonical href=https://0xninja.fr/tags/writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.min.00639c023f67c81a08cf1284873223d9b1f92ead1a4e7aa5649e77dcdd8a0e64.css integrity="sha256-AGOcAj9nyBoIzxKEhzIj2bH5Lq0aTnqlZJ533N2KDmQ=" rel="preload stylesheet" as=style><link rel=icon href=https://0xninja.fr/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://0xninja.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0xninja.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://0xninja.fr/apple-touch-icon.png><link rel=mask-icon href=https://0xninja.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><link rel=alternate type=application/rss+xml href=https://0xninja.fr/tags/writeup/index.xml><meta property="og:title" content="writeup"><meta property="og:description" content="I love to share ~~flags~~ knowledge, I write sometimes about CTF, challenges and other common subjects like Peano's arithmetic or Kerbal Space Program."><meta property="og:type" content="website"><meta property="og:url" content="https://0xninja.fr/tags/writeup/"><meta name=twitter:card content="summary"><meta name=twitter:title content="writeup"><meta name=twitter:description content="I love to share ~~flags~~ knowledge, I write sometimes about CTF, challenges and other common subjects like Peano's arithmetic or Kerbal Space Program."></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://0xninja.fr accesskey=h title="0xNinja - My blog (Alt + H)">0xNinja - My blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://0xninja.fr/about/ title="🥷 About"><span>🥷 About</span></a></li><li><a href=https://0xninja.fr/archives/ title="📝 Archives"><span>📝 Archives</span></a></li><li><a href=https://0xninja.fr/tags/ title="🏷️ Tags"><span>🏷️ Tags</span></a></li><li><a href=https://0xninja.fr/projects/ title="🔬 Projects"><span>🔬 Projects</span></a></li><li><a href=https://0xninja.fr/search/ title="🔎 Search (Alt + /)" accesskey=/><span>🔎 Search</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>writeup</h1></header><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-previse/box_hue559bffb5c5559ac38736f3a3727cd7a_34917_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-previse/box_hue559bffb5c5559ac38736f3a3727cd7a_34917_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-previse/box_hue559bffb5c5559ac38736f3a3727cd7a_34917_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-previse/box.png 751w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-previse/box.png alt></figure><header class=entry-header><h2>📦 HTB - Previse</h2></header><section class=entry-content><p>TL;DR Bypass PHP redirect to access restricted page, create low priv web account, get website backup. Audit code and find OS command injection + MySQL creds, get reverse shell and dump database, get password hash and crack it to SSH. Privesc via path injection.
Footholds nmap gives us only ports 22 and 80.
We first get this website:
Nothing we can deal with here, no SQL injection :(
For more info I used dirsearch to fuzz the web pages, and it found the following:...</p></section><footer class=entry-footer>August 11, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - Previse" href=https://0xninja.fr/posts/htb-previse/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-schooled/box_hu034653defd9b5eb62fc5cb5de3584561_26817_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-schooled/box_hu034653defd9b5eb62fc5cb5de3584561_26817_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-schooled/box_hu034653defd9b5eb62fc5cb5de3584561_26817_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-schooled/box.png 771w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-schooled/box.png alt></figure><header class=entry-header><h2>📦 HTB - Schooled</h2></header><section class=entry-content><p>Cool box, not too CTF-like and real-life applicable, my first FreeBSD 😄 But root part was too quick.
TL;DR XSS to steal Moodle creds of teacher, privesc as manager and then RCE. Get MySQL in config file, dump users and get password hash. Break the hash with john to ssh as user. Common pkg install exploit for root.
Footholds # Nmap 7.91 scan initiated Mon Aug 2 22:40:05 2021 as: nmap -A -p- -T4 -o nmap....</p></section><footer class=entry-footer>August 4, 2021&nbsp;·&nbsp;4 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - Schooled" href=https://0xninja.fr/posts/htb-schooled/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-bountyhunter/box_hu8f5f6cb83814f25ae31e9e24bf74fd68_28042_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-bountyhunter/box_hu8f5f6cb83814f25ae31e9e24bf74fd68_28042_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-bountyhunter/box_hu8f5f6cb83814f25ae31e9e24bf74fd68_28042_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-bountyhunter/box.png 775w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-bountyhunter/box.png alt></figure><header class=entry-header><h2>📦 HTB - BountyHunter</h2></header><section class=entry-content><p>⚠️ writeup wrote months after root so informations are not accurate.
TL;DR JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.
Recon Only HTTP and SSH, nothing special.
Footholds We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to /log_submit....</p></section><footer class=entry-footer>July 29, 2021&nbsp;·&nbsp;1 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - BountyHunter" href=https://0xninja.fr/posts/htb-bountyhunter/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-explore/box_hub30624d1c2c19f4782f38cc3f00910b0_24315_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-explore/box_hub30624d1c2c19f4782f38cc3f00910b0_24315_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-explore/box_hub30624d1c2c19f4782f38cc3f00910b0_24315_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-explore/box.png 773w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-explore/box.png alt></figure><header class=entry-header><h2>📦 HTB - Explore</h2></header><section class=entry-content><p>Pretty interesting box, first time seeing Android in HTB.
TL;DR Exfilter files on device using ES File explorer exploit, get user credentials. Root is straightforward with ADB.
Footholds With nmap we get the following:
# Nmap 7.91 scan initiated Wed Jul 28 14:49:28 2021 as: nmap -A -p- -o nmap.out explore.htb Nmap scan report for explore.htb (10.10.10.247) Host is up (0.043s latency). Not shown: 65530 closed ports PORT STATE SERVICE VERSION 2222/tcp open ssh (protocol 2....</p></section><footer class=entry-footer>July 29, 2021&nbsp;·&nbsp;2 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - Explore" href=https://0xninja.fr/posts/htb-explore/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-cap/box_hua675b45e45325a0c9a2eeaa72420d4c4_24014_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-cap/box_hua675b45e45325a0c9a2eeaa72420d4c4_24014_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-cap/box_hua675b45e45325a0c9a2eeaa72420d4c4_24014_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-cap/box.png 772w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-cap/box.png alt></figure><header class=entry-header><h2>📦 HTB - Cap</h2></header><section class=entry-content><p>Simple easy box, perfect to warmup before the FIC 2021 and get more confidence in 1337 h4ck1n9
TL;DR Find PCAP file on server, get SSH credentials, execute code as root with Python.
Footholds I did not even use nmap here, as we had a web server serving on port tcp:80. This website looked like this:
It seems to be a security dashboard for a server, we don’t have any info about that....</p></section><footer class=entry-footer>July 28, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - Cap" href=https://0xninja.fr/posts/htb-cap/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-ready/box_huf77b4b1b86c26a983581065f36f2b825_65135_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-ready/box_huf77b4b1b86c26a983581065f36f2b825_65135_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-ready/box_huf77b4b1b86c26a983581065f36f2b825_65135_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-ready/box.png 986w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-ready/box.png alt></figure><header class=entry-header><h2>📦 HTB - Ready</h2></header><section class=entry-content><p>Cool box, maybe too easy for a medium? Got reverse shell in minutes, but stuck for root’s password for hours 😅
TL;DR Gitlab RCE, get reverse shell. Privesc with cleartext root password, escape Docker to own the box.
Footholds nmap Starting Nmap 7.80 ( https://nmap.org ) at 2021-03-14 16:00 UTC Nmap scan report for 10.10.10.220 Host is up (0.035s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8....</p></section><footer class=entry-footer>March 20, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - Ready" href=https://0xninja.fr/posts/htb-ready/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>SQLi lab solutions</h2></header><section class=entry-content><p>Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.
The lab currently contains 5 levels, and I will update this post as I add more of them 👍
Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.
First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:...</p></section><footer class=entry-footer>August 20, 2020&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to SQLi lab solutions" href=https://0xninja.fr/posts/sqli-lab/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-magic/box_huba19b62044f1fcd80252bc62cda1127f_62418_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-magic/box_huba19b62044f1fcd80252bc62cda1127f_62418_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-magic/box_huba19b62044f1fcd80252bc62cda1127f_62418_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-magic/box.png 968w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-magic/box.png alt></figure><header class=entry-header><h2>📦 HTB - Magic</h2></header><section class=entry-content><p>TL;DR HTTP redirect bypass (unintended 😁), PHP code execution through file upload to get a reverse shell. User with hardcoded SQL credentials on server, privesc with custom binary with no $PATH check.
As I am an idiot, I reinstalled my distribution without making a backup of my files 🙈 So I don’t have any screenshot or payloads I used for this box to show you
Footholds With a basic nmap we found only two ports: 22 and 80....</p></section><footer class=entry-footer>August 20, 2020&nbsp;·&nbsp;3 min&nbsp;·&nbsp;0xNinja</footer><a class=entry-link aria-label="post link to 📦 HTB - Magic" href=https://0xninja.fr/posts/htb-magic/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://0xninja.fr/tags/writeup/page/2/>Next Page »</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href=https://0xninja.fr>0xNinja - My blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>