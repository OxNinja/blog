<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>üèåÔ∏è Binary golfing - Introduction | 0xNinja - My blog</title><meta name=keywords content="binary,elf,golf,low-level"><meta name=description content="So tmp.out - once again - got me. Especially netspooky, wich wrote about golfing binaries. Instantly I was caught in golfing.
 Binary golfing? Crafting the smallest binary which does a particular task.
Why someone would do this?
 Learn about binary executables and format parsers Flex on muggles  My notes on ELF format It is recommanded to code in assembly in order to manage your headers as you wish."><meta name=author content="0xNinja"><link rel=canonical href=https://0xninja.fr/posts/binary-golf/><link crossorigin=anonymous href=/assets/css/stylesheet.min.00639c023f67c81a08cf1284873223d9b1f92ead1a4e7aa5649e77dcdd8a0e64.css integrity="sha256-AGOcAj9nyBoIzxKEhzIj2bH5Lq0aTnqlZJ533N2KDmQ=" rel="preload stylesheet" as=style><link rel=icon href=https://0xninja.fr/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://0xninja.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0xninja.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://0xninja.fr/apple-touch-icon.png><link rel=mask-icon href=https://0xninja.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="üèåÔ∏è Binary golfing - Introduction"><meta property="og:description" content="So tmp.out - once again - got me. Especially netspooky, wich wrote about golfing binaries. Instantly I was caught in golfing.
 Binary golfing? Crafting the smallest binary which does a particular task.
Why someone would do this?
 Learn about binary executables and format parsers Flex on muggles  My notes on ELF format It is recommanded to code in assembly in order to manage your headers as you wish."><meta property="og:type" content="article"><meta property="og:url" content="https://0xninja.fr/posts/binary-golf/"><meta property="og:image" content="https://0xninja.fr/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-15T16:00:00+00:00"><meta property="article:modified_time" content="2022-04-15T16:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xninja.fr/cover.png"><meta name=twitter:title content="üèåÔ∏è Binary golfing - Introduction"><meta name=twitter:description content="So tmp.out - once again - got me. Especially netspooky, wich wrote about golfing binaries. Instantly I was caught in golfing.
 Binary golfing? Crafting the smallest binary which does a particular task.
Why someone would do this?
 Learn about binary executables and format parsers Flex on muggles  My notes on ELF format It is recommanded to code in assembly in order to manage your headers as you wish."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://0xninja.fr/posts/"},{"@type":"ListItem","position":3,"name":"üèåÔ∏è Binary golfing - Introduction","item":"https://0xninja.fr/posts/binary-golf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"üèåÔ∏è Binary golfing - Introduction","name":"üèåÔ∏è Binary golfing - Introduction","description":"So tmp.out - once again - got me. Especially netspooky, wich wrote about golfing binaries. Instantly I was caught in golfing.\n Binary golfing? Crafting the smallest binary which does a particular task.\nWhy someone would do this?\n Learn about binary executables and format parsers Flex on muggles  My notes on ELF format It is recommanded to code in assembly in order to manage your headers as you wish.","keywords":["binary","elf","golf","low-level"],"articleBody":" So tmp.out - once again - got me. Especially netspooky, wich wrote about golfing binaries. Instantly I was caught in golfing.\n Binary golfing? Crafting the smallest binary which does a particular task.\nWhy someone would do this?\n Learn about binary executables and format parsers Flex on muggles  My notes on ELF format It is recommanded to code in assembly in order to manage your headers as you wish.\nWe can handcraft binaries, because GCC is a bit messy when compiling code ans linking stuff. We can then make sections or headers overlap to save more space.\n In brief, the section header table is for use by the compiler and linker, while the program header table is for use by the program loader. The program header table is optionnal and never present in practice, the section header table is also optional but always present.\n Brian Raiter, ‚ÄúA Whirlwind Tutorial on Creating Really Teensy ELF Executables for Linux‚Äù   Compile Classic way:\n1 2  nasm -f elf32 file.s ld -m elf_i386 -nmagic file.o -o bin   Better:\nTo directly craft a binary: nasm -f bin file.s.\nHeader The smallest valid header I can think of might be:\n7f45 4c46 01?? ???? ???? ???? ???? ???? 0200 0300 0100 ???? dead beef 2c00 0000 ???? ???? ???? ???? 3400 2000 0100 0000 ???? ???? 0000 0008 0000 0008 !!!! !!!! !!!! !!!! 0500 0000 0010 0000 Considering the following:\n ??: garbage, so you can just use those bytes for shellcode !!!! !!!!: total size of the header, so it will depend on your code dead beef: address of the entrypoint  Here is a template I modified from here, so all creds to the author:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  bits 32 org 0x8000000 ehdr: ; Elf32_Ehdr db 0x7F, \"ELF\", 1, 1, 1, 0 ; e_ident times 8 db 0 dw 2 ; e_type dw 3 ; e_machine dd 1 ; e_version dd _start ; e_entry dd phdr - $$ ; e_phoff dd 0 ; e_shoff dd 0 ; e_flags dw ehdrsize ; e_ehsize dw phdrsize ; e_phentsize dw 1 ; e_phnum dw 0 ; e_shentsize dw 0 ; e_shnum dw 0 ; e_shstrndx  ehdrsize equ$ - ehdr phdr: ; Elf32_Phdr dd 1 ; p_type dd 0 ; p_offset dd $$ ; p_vaddr dd $$ ; p_paddr dd filesize ; p_filesz dd filesize ; p_memsz dd 5 ; p_flags dd 0x1000 ; p_align  phdrsize equ$ - phdr _start: ; your program here  filesize equ$ - $$   Unethical stuff Declaring variables in the wild üôà Nothing forbidens to declare variables anywhere, to save some space you can skip using the .rodata section.\n1 2  section .text var: db \"salut\", 0xa   Use header as code section üß† big brain move here: put code in the header\n1 2 3 4 5 6 7 8 9 10 11 12 13  ehdr: db 0x7f, \"ELF\" db 1, 1, 1, 0, 0 _start: mov bl, 42 xor eax, eax inc eax int 0x80 ;; continue le header \tdw 2 dw 3 dw 1 ;; ...   Golfing resources https://codegolf.stackexchange.com/questions/5696/shortest-elf-for-hello-world-n Create tiny ELF for Linux https://www.muppetlabs.com/~breadbox/software/tiny/ Analyzing ELF with malformed headers\n","wordCount":"553","inLanguage":"en","image":"https://0xninja.fr/cover.png","datePublished":"2022-04-15T16:00:00Z","dateModified":"2022-04-15T16:00:00Z","author":{"@type":"Person","name":"0xNinja"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://0xninja.fr/posts/binary-golf/"},"publisher":{"@type":"Organization","name":"0xNinja - My blog","logo":{"@type":"ImageObject","url":"https://0xninja.fr/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://0xninja.fr accesskey=h title="0xNinja - My blog (Alt + H)">0xNinja - My blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://0xninja.fr/about/ title="ü•∑ About"><span>ü•∑ About</span></a></li><li><a href=https://0xninja.fr/archives/ title="üìù Archives"><span>üìù Archives</span></a></li><li><a href=https://0xninja.fr/tags/ title="üè∑Ô∏è Tags"><span>üè∑Ô∏è Tags</span></a></li><li><a href=https://0xninja.fr/projects/ title="üî¨ Projects"><span>üî¨ Projects</span></a></li><li><a href=https://0xninja.fr/search/ title="üîé Search (Alt + /)" accesskey=/><span>üîé Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://0xninja.fr>Home</a>&nbsp;¬ª&nbsp;<a href=https://0xninja.fr/posts/>Posts</a></div><h1 class=post-title>üèåÔ∏è Binary golfing - Introduction<div class=entry-isdraft><sup>&nbsp;&nbsp;[draft]</sup></div></h1><div class=post-meta>April 15, 2022&nbsp;¬∑&nbsp;3 min&nbsp;¬∑&nbsp;0xNinja</div></header><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/binary-golf/cover_hu269cbc3494fc682c5827e7b992576596_67462_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/binary-golf/cover_hu269cbc3494fc682c5827e7b992576596_67462_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/binary-golf/cover_hu269cbc3494fc682c5827e7b992576596_67462_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/binary-golf/cover.png 761w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/binary-golf/cover.png alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#binary-golfing aria-label="Binary golfing?">Binary golfing?</a></li><li><a href=#my-notes-on-elf-format aria-label="My notes on ELF format">My notes on ELF format</a><ul><li><a href=#compile aria-label=Compile>Compile</a></li><li><a href=#header aria-label=Header>Header</a></li><li><a href=#unethical-stuff aria-label="Unethical stuff">Unethical stuff</a><ul><li><a href=#declaring-variables-in-the-wild aria-label="Declaring variables in the wild">Declaring variables in the wild</a></li><li><a href=#use-header-as-code-section aria-label="Use header as code section">Use header as code section</a></li></ul></li><li><a href=#golfing-resources aria-label="Golfing resources">Golfing resources</a></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>So <a href=https://tmpout.sh>tmp.out</a> - once again - got me. Especially <a href=https://n0.lol/>netspooky</a>, wich wrote about golfing binaries. Instantly I was caught in golfing.</p></blockquote><h2 id=binary-golfing>Binary golfing?<a hidden class=anchor aria-hidden=true href=#binary-golfing>#</a></h2><p>Crafting the smallest binary which does a particular task.</p><p><strong>Why someone would do this?</strong></p><ul><li>Learn about binary executables and format parsers</li><li>Flex on muggles</li></ul><h2 id=my-notes-on-elf-format>My notes on ELF format<a hidden class=anchor aria-hidden=true href=#my-notes-on-elf-format>#</a></h2><p>It is recommanded to code in assembly in order to manage your headers as you wish.</p><p>We can handcraft binaries, because <code>GCC</code> is a bit messy when compiling code ans linking stuff. We can then make sections or headers overlap to save more space.</p><blockquote><p>In brief, the section header table is for use by the compiler and linker, while the program header table is for use by the program loader.
The program header table is optionnal and never present in practice, the section header table is also optional but always present.</p><ul><li>Brian Raiter, &ldquo;A Whirlwind Tutorial on Creating Really Teensy ELF Executables for Linux&rdquo;</li></ul></blockquote><h3 id=compile>Compile<a hidden class=anchor aria-hidden=true href=#compile>#</a></h3><p><strong>Classic way:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nasm -f elf32 file.s
ld -m elf_i386 -nmagic file.o -o bin
</code></pre></td></tr></table></div></div><p><strong>Better:</strong></p><p>To directly craft a binary: <code>nasm -f bin file.s</code>.</p><h3 id=header>Header<a hidden class=anchor aria-hidden=true href=#header>#</a></h3><p>The smallest valid header I can think of might be:</p><pre><code class=language-hex data-lang=hex>7f45 4c46 01?? ???? ???? ???? ???? ????
0200 0300 0100 ???? dead beef 2c00 0000
???? ???? ???? ???? 3400 2000 0100 0000
???? ???? 0000 0008 0000 0008 !!!! !!!!
!!!! !!!! 0500 0000 0010 0000
</code></pre><p>Considering the following:</p><ul><li><code>??</code>: garbage, so you can just use those bytes for shellcode</li><li><code>!!!! !!!!</code>: total size of the header, so it will depend on your code</li><li><code>dead beef</code>: address of the entrypoint</li></ul><p>Here is a template I modified from <a href=https://www.muppetlabs.com/~breadbox/software/tiny/teensy.html>here, so all creds to the author</a>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#a6e22e>bits</span> <span style=color:#ae81ff>32</span>

<span style=color:#a6e22e>org</span> <span style=color:#ae81ff>0x8000000</span>

ehdr:                           <span style=color:#75715e>; Elf32_Ehdr
</span><span style=color:#75715e></span><span style=color:#a6e22e>db</span> <span style=color:#ae81ff>0x7F</span>, <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#66d9ef>ELF</span><span style=color:#960050;background-color:#1e0010>&#34;</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>      <span style=color:#75715e>; e_ident
</span><span style=color:#75715e></span><span style=color:#66d9ef>times</span> <span style=color:#ae81ff>8</span> <span style=color:#66d9ef>db</span> <span style=color:#ae81ff>0</span>
<span style=color:#a6e22e>dw</span> <span style=color:#ae81ff>2</span>                            <span style=color:#75715e>; e_type
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#ae81ff>3</span>                            <span style=color:#75715e>; e_machine
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#ae81ff>1</span>                            <span style=color:#75715e>; e_version
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#66d9ef>_start</span>                       <span style=color:#75715e>; e_entry
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#66d9ef>phdr</span> - <span style=color:#66d9ef>$$</span>                    <span style=color:#75715e>; e_phoff
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#ae81ff>0</span>                            <span style=color:#75715e>; e_shoff
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#ae81ff>0</span>                            <span style=color:#75715e>; e_flags
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#66d9ef>ehdrsize</span>                     <span style=color:#75715e>; e_ehsize
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#66d9ef>phdrsize</span>                     <span style=color:#75715e>; e_phentsize
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#ae81ff>1</span>                            <span style=color:#75715e>; e_phnum
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#ae81ff>0</span>                            <span style=color:#75715e>; e_shentsize
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#ae81ff>0</span>                            <span style=color:#75715e>; e_shnum
</span><span style=color:#75715e></span><span style=color:#66d9ef>dw</span> <span style=color:#ae81ff>0</span>                            <span style=color:#75715e>; e_shstrndx
</span><span style=color:#75715e></span>
<span style=color:#a6e22e>ehdrsize</span> <span style=color:#66d9ef>equ$</span> - <span style=color:#66d9ef>ehdr</span>

phdr:                           <span style=color:#75715e>; Elf32_Phdr
</span><span style=color:#75715e></span><span style=color:#a6e22e>dd</span> <span style=color:#ae81ff>1</span>                            <span style=color:#75715e>; p_type
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#ae81ff>0</span>                            <span style=color:#75715e>; p_offset
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#66d9ef>$$</span>                           <span style=color:#75715e>; p_vaddr
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#66d9ef>$$</span>                           <span style=color:#75715e>; p_paddr
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#66d9ef>filesize</span>                     <span style=color:#75715e>; p_filesz
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#66d9ef>filesize</span>                     <span style=color:#75715e>; p_memsz
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#ae81ff>5</span>                            <span style=color:#75715e>; p_flags
</span><span style=color:#75715e></span><span style=color:#66d9ef>dd</span> <span style=color:#ae81ff>0x1000</span>                       <span style=color:#75715e>; p_align
</span><span style=color:#75715e></span>
<span style=color:#a6e22e>phdrsize</span> <span style=color:#66d9ef>equ$</span> - <span style=color:#66d9ef>phdr</span>

_start:

<span style=color:#75715e>; your program here
</span><span style=color:#75715e></span>
<span style=color:#a6e22e>filesize</span> <span style=color:#66d9ef>equ$</span> - <span style=color:#66d9ef>$$</span>
</code></pre></td></tr></table></div></div><h3 id=unethical-stuff>Unethical stuff<a hidden class=anchor aria-hidden=true href=#unethical-stuff>#</a></h3><h4 id=declaring-variables-in-the-wild>Declaring variables in the wild<a hidden class=anchor aria-hidden=true href=#declaring-variables-in-the-wild>#</a></h4><p>üôà Nothing forbidens to declare variables anywhere, to save some space you can skip using the <code>.rodata</code> section.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#a6e22e>section</span> <span style=color:#66d9ef>.text</span>
	var: <span style=color:#a6e22e>db</span> <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#66d9ef>salut</span><span style=color:#960050;background-color:#1e0010>&#34;</span>, <span style=color:#ae81ff>0xa</span>
</code></pre></td></tr></table></div></div><h4 id=use-header-as-code-section>Use header as code section<a hidden class=anchor aria-hidden=true href=#use-header-as-code-section>#</a></h4><p><strong>üß†</strong> big brain move here: put code in the header</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm>ehdr:
	<span style=color:#a6e22e>db</span> <span style=color:#ae81ff>0x7f</span>, <span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#66d9ef>ELF</span><span style=color:#960050;background-color:#1e0010>&#34;</span>
	<span style=color:#a6e22e>db</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>
_start:
	<span style=color:#a6e22e>mov</span> <span style=color:#66d9ef>bl</span>, <span style=color:#ae81ff>42</span>
	<span style=color:#a6e22e>xor</span> <span style=color:#66d9ef>eax</span>, <span style=color:#66d9ef>eax</span>
	<span style=color:#a6e22e>inc</span> <span style=color:#66d9ef>eax</span>
	<span style=color:#a6e22e>int</span> <span style=color:#ae81ff>0x80</span>
	<span style=color:#75715e>;; continue le header
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>dw</span> <span style=color:#ae81ff>2</span>
	<span style=color:#a6e22e>dw</span> <span style=color:#ae81ff>3</span>
	<span style=color:#a6e22e>dw</span> <span style=color:#ae81ff>1</span>
	<span style=color:#75715e>;; ...
</span></code></pre></td></tr></table></div></div><h3 id=golfing-resources>Golfing resources<a hidden class=anchor aria-hidden=true href=#golfing-resources>#</a></h3><p><a href=https://codegolf.stackexchange.com/questions/5696/shortest-elf-for-hello-world-n>https://codegolf.stackexchange.com/questions/5696/shortest-elf-for-hello-world-n</a>
<a href=https://www.muppetlabs.com/~breadbox/software/tiny/teensy.html>Create tiny ELF for Linux</a>
<a href=https://www.muppetlabs.com/~breadbox/software/tiny/>https://www.muppetlabs.com/~breadbox/software/tiny/</a>
<a href=https://binaryresearch.github.io/2019/09/17/Analyzing-ELF-Binaries-with-Malformed-Headers-Part-1-Emulating-Tiny-Programs.html>Analyzing ELF with malformed headers</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://0xninja.fr/tags/binary/>binary</a></li><li><a href=https://0xninja.fr/tags/elf/>elf</a></li><li><a href=https://0xninja.fr/tags/golf/>golf</a></li><li><a href=https://0xninja.fr/tags/low-level/>low-level</a></li></ul><nav class=paginav><a class=next href=https://0xninja.fr/posts/assembly-vm/><span class=title>Next Page ¬ª</span><br><span>üîé Creating a VM for fun - Part 1: ASM</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://0xninja.fr>0xNinja - My blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>