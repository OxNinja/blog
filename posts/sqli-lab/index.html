<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SQLi lab solutions | 0xNinja - My blog</title><meta name=keywords content="article,ctf,sqli,writeup"><meta name=description content="Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.
 The lab currently contains 5 levels, and I will update this post as I add more of them üëç
 Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.
First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:"><meta name=author content="0xNinja"><link rel=canonical href=http://example.org/posts/sqli-lab/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ba88f41f11a10b879278bfa0e5f4846fcc23eb1705121ab38cfd85f1b1749b7f.css integrity="sha256-uoj0HxGhC4eSeL+g5fSEb8wj6xcFEhqzjP2F8bF0m38=" rel="preload stylesheet" as=style><link rel=icon href=http://example.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://example.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://example.org/favicon-32x32.png><link rel=apple-touch-icon href=http://example.org/apple-touch-icon.png><link rel=mask-icon href=http://example.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.79.1"><meta property="og:title" content="SQLi lab solutions"><meta property="og:description" content="Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.
 The lab currently contains 5 levels, and I will update this post as I add more of them üëç
 Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.
First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:"><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/sqli-lab/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-20T14:00:01+00:00"><meta property="article:modified_time" content="2020-08-20T14:00:01+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SQLi lab solutions"><meta name=twitter:description content="Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.
 The lab currently contains 5 levels, and I will update this post as I add more of them üëç
 Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.
First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://example.org/posts/"},{"@type":"ListItem","position":2,"name":"SQLi lab solutions","item":"http://example.org/posts/sqli-lab/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SQLi lab solutions","name":"SQLi lab solutions","description":"Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.\n The lab currently contains 5 levels, and I will update this post as I add more of them üëç\n Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.\nFirst I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:","keywords":["article","ctf","sqli","writeup"],"articleBody":"Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.\n The lab currently contains 5 levels, and I will update this post as I add more of them üëç\n Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.\nFirst I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:\n1 2 3 4  git clone https://github.com/OxNinja/SQLi-lab.git cd SQLi-lab echo '172.16.0.2 sqli.lab'  /etc/hosts ./build.sh   Let‚Äôs wait for about 5-10 seconds for the MySQL container to boot, and then visit http://172.16.0.2, or http://sqli.lab, you should get this:\nWe can now start level 1!\nLevel 1 By reading the level‚Äôs introduction, we know that the admin uses a database with its passwords. We want to get them all, without having to guess the website. But first we need to know how the server works.\nBy inputing a random website we get:\nThe output is not that verbose, but we might be able to guess the SQL query made:\n1  SELECT password FROM my_table WHERE website='$website'   So let‚Äôs try a basic injection, like ' or 1=1-- -:\nOkay we got him, we have the URL for the next level.\nLevel 2 Here we need to retrieve the admin‚Äôs password. Let‚Äôs try admin:admin:\nOf course we don‚Äôt have anything. With the information we have, we can imagine the SQL query:\n1  SELECT username, mail, password FROM users WHERE username='$username' AND password='$password'   We can try again with a basic injection ' or 1=1;-- -:\nIt works fine üòä\nWe could also have injected the payload in the password field:\nLevel 3 An online shop! We must find what is hidding in there. But first, let‚Äôs use this product search input:\nNothing really interesting üòê\nBut we see a message on the page: ‚ÄòLogin is disabled for the moment.' what is this? Maybe we could see something in the source code?\nBingo! We have an SQL query, but how can we use it? The only solution here is to make an UNION-based SQL injection. Let‚Äôs try it out:\n1  UNION SELECT * FROM level3_users   Should do the trick. Our payload: ' UNION SELECT * FROM leve3_users;-- -\nYes it works! We continue to the fourth level.\nLevel 4 This level might be harder than the previous ones for some attackers. And it is normal üòà\nThe page shows us some buttons we can click to get an article‚Äôs content:\nNote the ?id= parameter in the URL this could help us in the future.\nLet‚Äôs see the generated source code:\nHow interesting, the server adds a comment containing the article‚Äôs id right before its content.\nHere we don‚Äôt have that much information. Our only escape could be ‚Äì again ‚Äì an UNION-based SQLi. Let‚Äôs try one:\nWe don‚Äôt get anything from it, even if we provided an article‚Äôs id üòï\nThe right thing to ask is: why? Why do we get nothing with our payload? Why is the article 3 not even rendered?\nIn an UNION query, both SELECT statements must return the same number of columns! So maybe we are wrong, maybe there is not two columns in the server‚Äôs query. We can figure out the server‚Äôs query:\n1  SELECT * FROM articles WHERE id='$id'   But how many columns are in there? We can count what we see on the page: the title and the content of the article‚Ä¶ AND the id! Those are three columns. Let‚Äôs try with three columns:\nWe now have a second article rendered on the page! We can try to customize our payload to select strings or values:\nNice it works as we want! We now want to know the database‚Äôs name:\nOK, now we want to know the tables of the database:\nNote the limit 1,1 at the end, we need it in order to retrieve one by one. Otherwise the UNION query will get an error because we want to SELECT more elements than the first statement.\nHere we get the table COLLATIONS, which is part of the MySQL‚Äôs server by default. We only want the tables from our database database:\nOK now we want to get the columns of this table:\nContinuing like this we get the database‚Äôs schema:\n1 2 3 4  CREATE DATABASE database; CREATE TABLE level4_articles (id int, title text, content text); CREATE TABLE level4_users (username text, password text);   Level 5 We want to find the admin‚Äôs password. Let‚Äôs try the basic admin:admin:\nOf course we got a ‚ÄúWrong username/password‚Äù message. Maybe we can try a basic SQLi?\nNice, the server think we are admin! But the goal here is to find the password, not to log as him.\nWe now know that this form is vulnerable to SQL injections, and when we are logged as the admin we have a ‚ÄúWelcome admin‚Äù message. Maybe we can try a blind injection like so:\nBetter! we transformed the query:\n1 2 3 4  # From: SELECT * FROM users WHERE username='$username' AND password='$password' # To: SELECT * FROM users WHERE username='admin' AND password='' OR password LIKE '%';-- -'   Which can lead us to the admin‚Äôs password! Let‚Äôs continue like so:\nWe now know that the first character of the password is not ‚Äúa‚Äù. Great! Moving on by changing the letter each time we get the first letter: ‚Äúf‚Äù\nWe now have a method to find the whole password, so I will skip to the end untill the final check:\nAfter this point, no matter what the next character is, we get the ‚ÄúWrong username/password‚Äù message. This means that we reached the end of the password, let‚Äôs check it out:\nGreat! We know the admin‚Äôs password now. To continue we have to get to the page /f05c8652de134d5c50729fa1b31d355b.php.\nOn this page we are redirected to /win.php, meanning we got to the end of the lab.\nWe just finished the last level of this lab! It was fun, wasn‚Äôt it?\n","wordCount":"1012","inLanguage":"en","datePublished":"2020-08-20T14:00:01Z","dateModified":"2020-08-20T14:00:01Z","author":{"@type":"Person","name":"0xNinja"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://example.org/posts/sqli-lab/"},"publisher":{"@type":"Organization","name":"0xNinja - My blog","logo":{"@type":"ImageObject","url":"http://example.org/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: #1d1e20;--entry: #2e2e33;--primary: rgba(255, 255, 255, 0.84);--secondary: rgba(255, 255, 255, 0.56);--tertiary: rgba(255, 255, 255, 0.16);--content: rgba(255, 255, 255, 0.74);--hljs-bg: #2e2e33;--code-bg: #37383e;--border: #333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=http://example.org/ accesskey=h title="0xNinja - My blog (Alt + H)">0xNinja - My blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://example.org/about/ title="ü•∑ About"><span>ü•∑ About</span></a></li><li><a href=http://example.org/archives/ title="üìù Archives"><span>üìù Archives</span></a></li><li><a href=http://example.org/tags/ title="üè∑Ô∏è Tags"><span>üè∑Ô∏è Tags</span></a></li><li><a href=http://example.org/projects/ title="üî¨ Projects"><span>üî¨ Projects</span></a></li><li><a href=http://example.org/search/ title="üîé Search (Alt + /)" accesskey=/><span>üîé Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>SQLi lab solutions</h1><div class=post-meta>August 20, 2020&nbsp;¬∑&nbsp;0xNinja</div></header><div class=post-content><p>Some weeks ago I created a <a href=https://github.com/OxNinja/SQLi-lab>trainning lab for SQL injections called SQLi lab</a>. And I will go through all levels in this blog post, explainning the expected way to solve each of them.</p><p><img loading=lazy src=https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png alt="Lab picture"></p><blockquote><p>The lab currently contains <strong>5</strong> levels, and I will update this post as I add more of them üëç</p></blockquote><h2 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h2><p>The GitHub repository is at <a href=https://github.com/OxNinja/SQLi-lab>https://github.com/OxNinja/SQLi-lab</a> if you want more information.</p><p>First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/OxNinja/SQLi-lab.git
cd SQLi-lab
echo <span style=color:#e6db74>&#39;172.16.0.2 sqli.lab&#39;</span> &gt;&gt; /etc/hosts
./build.sh
</code></pre></td></tr></table></div></div><p>Let&rsquo;s wait for about 5-10 seconds for the MySQL container to boot, and then visit <code>http://172.16.0.2</code>, or <code>http://sqli.lab</code>, you should get this:</p><p><img loading=lazy src=https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png alt="Lab picture"></p><p>We can now start level 1!</p><h2 id=level-1>Level 1<a hidden class=anchor aria-hidden=true href=#level-1>#</a></h2><p><img loading=lazy src=level1.png alt="Level 1"></p><p>By reading the level&rsquo;s introduction, we know that the admin uses a database with its passwords. We want to get them all, without having to guess the website. But first we need to know how the server works.</p><p>By inputing a random website we get:</p><p><img loading=lazy src=level1-1.png alt="Standard output"></p><p>The output is not that verbose, but we might be able to guess the SQL query made:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> password <span style=color:#66d9ef>FROM</span> my_table <span style=color:#66d9ef>WHERE</span> website<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$website&#39;</span>
</code></pre></td></tr></table></div></div><p>So let&rsquo;s try a basic injection, like <code>' or 1=1-- -</code>:</p><p><img loading=lazy src=level1-2.png alt=Output></p><p>Okay we got him, we have the URL for the next level.</p><h2 id=level-2>Level 2<a hidden class=anchor aria-hidden=true href=#level-2>#</a></h2><p><img loading=lazy src=level2.png alt="Level 2"></p><p>Here we need to retrieve the admin&rsquo;s password. Let&rsquo;s try <code>admin:admin</code>:</p><p><img loading=lazy src=level2-1.png alt="admin:admin try"></p><p>Of course we don&rsquo;t have anything. With the information we have, we can imagine the SQL query:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> username, mail, password <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$username&#39;</span> <span style=color:#66d9ef>AND</span> password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$password&#39;</span>
</code></pre></td></tr></table></div></div><p>We can try again with a basic injection <code>' or 1=1;-- -</code>:</p><p><img loading=lazy src=level2-2.png alt=Output></p><p>It works fine üòä</p><p>We could also have injected the payload in the password field:</p><p><img loading=lazy src=level2-3.png alt=Output></p><h2 id=level-3>Level 3<a hidden class=anchor aria-hidden=true href=#level-3>#</a></h2><p><img loading=lazy src=level3.png alt="Level 3"></p><p>An online shop! We must find what is hidding in there. But first, let&rsquo;s use this product search input:</p><p><img loading=lazy src=level3-1.png alt=Output></p><p>Nothing really interesting üòê</p><p>But we see a message on the page: <em>&lsquo;Login is disabled for the moment.'</em> what is this? Maybe we could see something in the source code?</p><p><img loading=lazy src=level3-2.png alt="Source code"></p><p>Bingo! We have an SQL query, but how can we use it? The only solution here is to make an UNION-based SQL injection. Let&rsquo;s try it out:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> level3_users
</code></pre></td></tr></table></div></div><p>Should do the trick. Our payload: <code>' UNION SELECT * FROM leve3_users;-- -</code></p><p><img loading=lazy src=level3-3.png alt=Output></p><p>Yes it works! We continue to the fourth level.</p><h2 id=level-4>Level 4<a hidden class=anchor aria-hidden=true href=#level-4>#</a></h2><p><img loading=lazy src=level4.png alt="Level 4"></p><p><em>This level might be harder than the previous ones for some attackers. And it is normal üòà</em></p><p>The page shows us some buttons we can click to get an article&rsquo;s content:</p><p><img loading=lazy src=level4-1.png alt=Output></p><p>Note the <code>?id=</code> parameter in the URL this could help us in the future.</p><p>Let&rsquo;s see the generated source code:</p><p><img loading=lazy src=level4-2.png alt="Source code"></p><p>How interesting, the server adds a comment containing the article&rsquo;s id right before its content.</p><p>Here we don&rsquo;t have that much information. Our only escape could be &ndash; again &ndash; an UNION-based SQLi. Let&rsquo;s try one:</p><p><img loading=lazy src=level4-3.png alt=Output></p><p>We don&rsquo;t get anything from it, even if we provided an article&rsquo;s id üòï</p><p>The right thing to ask is: why? Why do we get nothing with our payload? Why is the article 3 not even rendered?</p><p>In an UNION query, both SELECT statements <strong>must</strong> return the same number of columns! So maybe we are wrong, maybe there is not two columns in the server&rsquo;s query. We can figure out the server&rsquo;s query:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> articles <span style=color:#66d9ef>WHERE</span> id<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$id&#39;</span>
</code></pre></td></tr></table></div></div><p>But how many columns are in there? We can count what we see on the page: the title and the content of the article&mldr; AND the id! Those are three columns. Let&rsquo;s try with three columns:</p><p><img loading=lazy src=level4-4.png alt=Output></p><p>We now have a second article rendered on the page! We can try to customize our payload to select strings or values:</p><p><img loading=lazy src=level4-5.png alt=Output></p><p>Nice it works as we want! We now want to know the database&rsquo;s name:</p><p><img loading=lazy src=level4-6.png alt=Output></p><p>OK, now we want to know the tables of the database:</p><p><img loading=lazy src=level4-7.png alt=Output></p><p>Note the <code>limit 1,1</code> at the end, we need it in order to retrieve one by one. Otherwise the UNION query will get an error because we want to SELECT more elements than the first statement.</p><p>Here we get the table <code>COLLATIONS</code>, which is part of the MySQL&rsquo;s server by default. We only want the tables from our database <code>database</code>:</p><p><img loading=lazy src=level4-8.png alt=Output></p><p>OK now we want to get the columns of this table:</p><p><img loading=lazy src=level4-9.png alt=Output></p><p>Continuing like this we get the database&rsquo;s schema:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> <span style=color:#66d9ef>database</span>;

<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> level4_articles (id int, title text, content text);
<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> level4_users (username text, password text);
</code></pre></td></tr></table></div></div><p><img loading=lazy src=level4-10.png alt=Output></p><h2 id=level-5>Level 5<a hidden class=anchor aria-hidden=true href=#level-5>#</a></h2><p><img loading=lazy src=level5.png alt=Level5></p><p>We want to find the admin&rsquo;s password. Let&rsquo;s try the basic <code>admin:admin</code>:</p><p><img loading=lazy src=level5-1.png alt=Output></p><p>Of course we got a &ldquo;Wrong username/password&rdquo; message. Maybe we can try a basic SQLi?</p><p><img loading=lazy src=level5-2.png alt=Output></p><p>Nice, the server think we are admin! But the goal here is to find the password, not to log as him.</p><p>We now know that this form is vulnerable to SQL injections, and when we are logged as the admin we have a &ldquo;Welcome admin&rdquo; message. Maybe we can try a blind injection like so:</p><p><img loading=lazy src=level5-3.png alt=Output></p><p>Better! we transformed the query:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#f92672>#</span> <span style=color:#66d9ef>From</span>:
<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$username&#39;</span> <span style=color:#66d9ef>AND</span> password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$password&#39;</span>
<span style=color:#f92672>#</span> <span style=color:#66d9ef>To</span>:
<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;admin&#39;</span> <span style=color:#66d9ef>AND</span> password<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span> <span style=color:#66d9ef>OR</span> password <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;%&#39;</span>;<span style=color:#75715e>-- -&#39;
</span></code></pre></td></tr></table></div></div><p>Which can lead us to the admin&rsquo;s password! Let&rsquo;s continue like so:</p><p><img loading=lazy src=level5-4.png alt=Output></p><p>We now know that the first character of the password is not &ldquo;a&rdquo;. Great! Moving on by changing the letter each time we get the first letter: &ldquo;f&rdquo;</p><p><img loading=lazy src=level5-5.png alt=Output></p><p>We now have a method to find the whole password, so I will skip to the end untill the final check:</p><p><img loading=lazy src=level5-6.png alt=Output></p><p>After this point, no matter what the next character is, we get the &ldquo;Wrong username/password&rdquo; message. This means that we reached the end of the password, let&rsquo;s check it out:</p><p><img loading=lazy src=level5-7.png alt=Output></p><p>Great! We know the admin&rsquo;s password now. To continue we have to get to the page <code>/f05c8652de134d5c50729fa1b31d355b.php</code>.</p><p>On this page we are redirected to <code>/win.php</code>, meanning we got to the end of the lab.</p><p><img loading=lazy src=win.png alt=Win></p><p>We just finished the last level of this lab! It was fun, wasn&rsquo;t it?</p><p><img loading=lazy src=https://media.giphy.com/media/XreQmk7ETCak0/giphy.gif alt=Congratulations></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://example.org/tags/article/>article</a></li><li><a href=http://example.org/tags/ctf/>ctf</a></li><li><a href=http://example.org/tags/sqli/>sqli</a></li><li><a href=http://example.org/tags/writeup/>writeup</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=http://example.org/>0xNinja - My blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu')
menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerText='copy';function copyingDone(){copybutton.innerText='copied!';setTimeout(()=>{copybutton.innerText='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>