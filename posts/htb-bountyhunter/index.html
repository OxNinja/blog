<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>üì¶ HTB - BountyHunter | 0xNinja - My blog</title><meta name=keywords content="htb,writeup"><meta name=description content="‚ö†Ô∏è writeup wrote months after root so informations are not accurate.
 TL;DR JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.
Recon Only HTTP and SSH, nothing special.
Footholds We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to /log_submit."><meta name=author content="0xNinja"><link rel=canonical href=https://0xninja.fr/posts/htb-bountyhunter/><link crossorigin=anonymous href=/assets/css/stylesheet.min.00639c023f67c81a08cf1284873223d9b1f92ead1a4e7aa5649e77dcdd8a0e64.css integrity="sha256-AGOcAj9nyBoIzxKEhzIj2bH5Lq0aTnqlZJ533N2KDmQ=" rel="preload stylesheet" as=style><link rel=icon href=https://0xninja.fr/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://0xninja.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0xninja.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://0xninja.fr/apple-touch-icon.png><link rel=mask-icon href=https://0xninja.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="üì¶ HTB - BountyHunter"><meta property="og:description" content="‚ö†Ô∏è writeup wrote months after root so informations are not accurate.
 TL;DR JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.
Recon Only HTTP and SSH, nothing special.
Footholds We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to /log_submit."><meta property="og:type" content="article"><meta property="og:url" content="https://0xninja.fr/posts/htb-bountyhunter/"><meta property="og:image" content="https://0xninja.fr/box.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-29T14:00:00+00:00"><meta property="article:modified_time" content="2021-07-29T14:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xninja.fr/box.png"><meta name=twitter:title content="üì¶ HTB - BountyHunter"><meta name=twitter:description content="‚ö†Ô∏è writeup wrote months after root so informations are not accurate.
 TL;DR JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.
Recon Only HTTP and SSH, nothing special.
Footholds We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to /log_submit."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://0xninja.fr/posts/"},{"@type":"ListItem","position":3,"name":"üì¶ HTB - BountyHunter","item":"https://0xninja.fr/posts/htb-bountyhunter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"üì¶ HTB - BountyHunter","name":"üì¶ HTB - BountyHunter","description":"‚ö†Ô∏è writeup wrote months after root so informations are not accurate.\n TL;DR JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.\nRecon Only HTTP and SSH, nothing special.\nFootholds We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to /log_submit.","keywords":["htb","writeup"],"articleBody":" ‚ö†Ô∏è writeup wrote months after root so informations are not accurate.\n TL;DR JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.\nRecon Only HTTP and SSH, nothing special.\nFootholds We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to /log_submit.php, here we have a custom XHR launched towards an internal API dirb_pr00f314.php. We see that XML is posted here so lets try a classic XXE:\nWe can leak source code with this, here are the files I got: db.php.\nWe get credentials:\n1 2 3 4 5 6 7 8  php // TODO - Implement login system with the database. $dbserver = \"localhost\"; $dbname = \"bounty\"; $dbusername = \"admin\"; $dbpassword = \"m19RoAU0hP41A1sTsq6K\"; $testuser = \"test\"; ?   [‚Ä¶]\nPrivesc Basic sudo -l:\nFrom that we have a local script to validate tickets: ticketValidator.py.\nHere we see an obvious code injection vulnerability in a custom ticket:\nWe cat get root:\n","wordCount":"181","inLanguage":"en","image":"https://0xninja.fr/box.png","datePublished":"2021-07-29T14:00:00Z","dateModified":"2021-07-29T14:00:00Z","author":{"@type":"Person","name":"0xNinja"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://0xninja.fr/posts/htb-bountyhunter/"},"publisher":{"@type":"Organization","name":"0xNinja - My blog","logo":{"@type":"ImageObject","url":"https://0xninja.fr/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://0xninja.fr accesskey=h title="0xNinja - My blog (Alt + H)">0xNinja - My blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://0xninja.fr/about/ title="ü•∑ About"><span>ü•∑ About</span></a></li><li><a href=https://0xninja.fr/archives/ title="üìù Archives"><span>üìù Archives</span></a></li><li><a href=https://0xninja.fr/tags/ title="üè∑Ô∏è Tags"><span>üè∑Ô∏è Tags</span></a></li><li><a href=https://0xninja.fr/projects/ title="üî¨ Projects"><span>üî¨ Projects</span></a></li><li><a href=https://0xninja.fr/search/ title="üîé Search (Alt + /)" accesskey=/><span>üîé Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://0xninja.fr>Home</a>&nbsp;¬ª&nbsp;<a href=https://0xninja.fr/posts/>Posts</a></div><h1 class=post-title>üì¶ HTB - BountyHunter</h1><div class=post-meta>July 29, 2021&nbsp;¬∑&nbsp;1 min&nbsp;¬∑&nbsp;0xNinja</div></header><figure class=entry-cover><img loading=lazy srcset="https://0xninja.fr/posts/htb-bountyhunter/box_hu8f5f6cb83814f25ae31e9e24bf74fd68_28042_360x0_resize_box_2.png 360w ,https://0xninja.fr/posts/htb-bountyhunter/box_hu8f5f6cb83814f25ae31e9e24bf74fd68_28042_480x0_resize_box_2.png 480w ,https://0xninja.fr/posts/htb-bountyhunter/box_hu8f5f6cb83814f25ae31e9e24bf74fd68_28042_720x0_resize_box_2.png 720w ,https://0xninja.fr/posts/htb-bountyhunter/box.png 775w" sizes="(min-width: 768px) 720px, 100vw" src=https://0xninja.fr/posts/htb-bountyhunter/box.png alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#tldr aria-label=TL;DR>TL;DR</a></li><li><a href=#recon aria-label=Recon>Recon</a></li><li><a href=#footholds aria-label=Footholds>Footholds</a></li><li><a href=#privesc aria-label=Privesc>Privesc</a></li></ul></div></details></div><div class=post-content><blockquote><p>‚ö†Ô∏è writeup wrote months after root so informations are not accurate.</p></blockquote><h2 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h2><p>JS source code disclosure to forge internal requests, leak PHP source code with XXE in custom request, get DB credentials. Privesc with code injection in custom code without input validation.</p><h2 id=recon>Recon<a hidden class=anchor aria-hidden=true href=#recon>#</a></h2><p>Only HTTP and SSH, nothing special.</p><h2 id=footholds>Footholds<a hidden class=anchor aria-hidden=true href=#footholds>#</a></h2><p>We have here a simple web server, with custom SJ script to send bounty tickets. The portal tells us to go to <code>/log_submit.php</code>, here we have a custom XHR launched towards an internal API <code>dirb_pr00f314.php</code>. We see that XML is posted here so lets try a classic XXE:</p><p><img loading=lazy src=tracker.png alt></p><p>We can leak source code with this, here are the files I got: <a href=db.php>db.php</a>.</p><p>We get credentials:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#f92672>&lt;?</span>php
<span style=color:#f92672>//</span> TODO <span style=color:#f92672>-&gt;</span> Implement login <span style=color:#66d9ef>system</span> <span style=color:#66d9ef>with</span> the <span style=color:#66d9ef>database</span>.
<span style=color:#960050;background-color:#1e0010>$</span>dbserver <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;localhost&#34;</span>;
<span style=color:#960050;background-color:#1e0010>$</span>dbname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bounty&#34;</span>;
<span style=color:#960050;background-color:#1e0010>$</span>dbusername <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;admin&#34;</span>;
<span style=color:#960050;background-color:#1e0010>$</span>dbpassword <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;m19RoAU0hP41A1sTsq6K&#34;</span>;
<span style=color:#960050;background-color:#1e0010>$</span>testuser <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;test&#34;</span>;
<span style=color:#f92672>?&gt;</span>
</code></pre></td></tr></table></div></div><p>[&mldr;]</p><h2 id=privesc>Privesc<a hidden class=anchor aria-hidden=true href=#privesc>#</a></h2><p>Basic <code>sudo -l</code>:</p><p><img loading=lazy src=sudo.png alt></p><p>From that we have a local script to validate tickets: <a href=ticketValidator.py>ticketValidator.py</a>.</p><p>Here we see an obvious code injection vulnerability in a custom ticket:</p><p><img loading=lazy src=ticket.png alt></p><p>We cat get root:</p><p><img loading=lazy src=root.png alt></p><p><img loading=lazy src=rooted.png alt=Rooted></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://0xninja.fr/tags/htb/>htb</a></li><li><a href=https://0xninja.fr/tags/writeup/>writeup</a></li></ul><nav class=paginav><a class=prev href=https://0xninja.fr/posts/htb-schooled/><span class=title>¬´ Prev Page</span><br><span>üì¶ HTB - Schooled</span></a>
<a class=next href=https://0xninja.fr/posts/htb-explore/><span class=title>Next Page ¬ª</span><br><span>üì¶ HTB - Explore</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://0xninja.fr>0xNinja - My blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>