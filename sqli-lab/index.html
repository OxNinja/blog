<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>SQLi lab solutions - 0xNinja - My blog</title><meta name=Description content="My personnal blog"><meta property="og:title" content="SQLi lab solutions"><meta property="og:description" content="Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.
The lab currently contains 5 levels, and I will update this post as I add more of them 👍
Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.
First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:"><meta property="og:type" content="article"><meta property="og:url" content="https://0xninja.fr/sqli-lab/"><meta property="og:image" content="https://0xninja.fr/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-20T14:00:01+00:00"><meta property="article:modified_time" content="2020-08-20T14:00:01+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xninja.fr/logo.png"><meta name=twitter:title content="SQLi lab solutions"><meta name=twitter:description content="Some weeks ago I created a trainning lab for SQL injections called SQLi lab. And I will go through all levels in this blog post, explainning the expected way to solve each of them.
The lab currently contains 5 levels, and I will update this post as I add more of them 👍
Installation The GitHub repository is at https://github.com/OxNinja/SQLi-lab if you want more information.
First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:"><meta name=application-name content="0xNinja.fr"><meta name=apple-mobile-web-app-title content="0xNinja.fr"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://0xninja.fr/sqli-lab/><link rel=prev href=https://0xninja.fr/htb-magic/><link rel=next href=https://0xninja.fr/htb-ready/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"SQLi lab solutions","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/0xninja.fr\/sqli-lab\/"},"image":["https:\/\/0xninja.fr\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"article, ctf, sqli, writeup","wordcount":1012,"url":"https:\/\/0xninja.fr\/sqli-lab\/","datePublished":"2020-08-20T14:00:01+00:00","dateModified":"2020-08-20T14:00:01+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"0xNinja","logo":"https:\/\/0xninja.fr\/images\/avatar.png"},"author":{"@type":"Person","name":"0xNinja"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="0xNinja - My blog"><span class=header-title-pre>🥷</span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>📝 Posts </a><a class=menu-item href=/tags/>🏷️ Tags </a><a class=menu-item href=/categories/>📚 Categories </a><a class=menu-item href=/projects/>🔬 Projects </a><a class=menu-item href=/about/>🥷 About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="0xNinja - My blog"><span class=header-title-pre>🥷</span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>📝Posts</a><a class=menu-item href=/tags/ title>🏷️Tags</a><a class=menu-item href=/categories/ title>📚Categories</a><a class=menu-item href=/projects/ title>🔬Projects</a><a class=menu-item href=/about/ title>🥷About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">SQLi lab solutions</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://0xninja.fr title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>0xNinja</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-08-20>2020-08-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1012 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#installation>Installation</a></li><li><a href=#level-1>Level 1</a></li><li><a href=#level-2>Level 2</a></li><li><a href=#level-3>Level 3</a></li><li><a href=#level-4>Level 4</a></li><li><a href=#level-5>Level 5</a></li></ul></nav></div></div><div class=content id=content><p>Some weeks ago I created a <a href=https://github.com/OxNinja/SQLi-lab target=_blank rel="noopener noreffer">trainning lab for SQL injections called SQLi lab</a>. And I will go through all levels in this blog post, explainning the expected way to solve each of them.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png data-srcset="https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png, https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png 1.5x, https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png title="Lab picture"></p><blockquote><p>The lab currently contains <strong>5</strong> levels, and I will update this post as I add more of them 👍</p></blockquote><h2 id=installation>Installation</h2><p>The GitHub repository is at <a href=https://github.com/OxNinja/SQLi-lab target=_blank rel="noopener noreffer">https://github.com/OxNinja/SQLi-lab</a> if you want more information.</p><p>First I clone the lab in a folder, add its IP to my hosts file for conveignance, and then build it with the given script:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/OxNinja/SQLi-lab.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> SQLi-lab
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;172.16.0.2 sqli.lab&#39;</span> &gt;&gt; /etc/hosts
</span></span><span class=line><span class=cl>./build.sh
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s wait for about 5-10 seconds for the MySQL container to boot, and then visit <code>http://172.16.0.2</code>, or <code>http://sqli.lab</code>, you should get this:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png data-srcset="https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png, https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png 1.5x, https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/OxNinja/SQLi-lab/master/static/index.png title="Lab picture"></p><p>We can now start level 1!</p><h2 id=level-1>Level 1</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level1.png data-srcset="/sqli-lab/level1.png, /sqli-lab/level1.png 1.5x, /sqli-lab/level1.png 2x" data-sizes=auto alt=/sqli-lab/level1.png title="Level 1" width=1914 height=394></p><p>By reading the level&rsquo;s introduction, we know that the admin uses a database with its passwords. We want to get them all, without having to guess the website. But first we need to know how the server works.</p><p>By inputing a random website we get:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level1-1.png data-srcset="/sqli-lab/level1-1.png, /sqli-lab/level1-1.png 1.5x, /sqli-lab/level1-1.png 2x" data-sizes=auto alt=/sqli-lab/level1-1.png title="Standard output" width=362 height=190></p><p>The output is not that verbose, but we might be able to guess the SQL query made:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>my_table</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>website</span><span class=o>=</span><span class=s1>&#39;$website&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s try a basic injection, like <code>' or 1=1-- -</code>:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level1-2.png data-srcset="/sqli-lab/level1-2.png, /sqli-lab/level1-2.png 1.5x, /sqli-lab/level1-2.png 2x" data-sizes=auto alt=/sqli-lab/level1-2.png title=Output width=599 height=252></p><p>Okay we got him, we have the URL for the next level.</p><h2 id=level-2>Level 2</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level2.png data-srcset="/sqli-lab/level2.png, /sqli-lab/level2.png 1.5x, /sqli-lab/level2.png 2x" data-sizes=auto alt=/sqli-lab/level2.png title="Level 2" width=1697 height=385></p><p>Here we need to retrieve the admin&rsquo;s password. Let&rsquo;s try <code>admin:admin</code>:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level2-1.png data-srcset="/sqli-lab/level2-1.png, /sqli-lab/level2-1.png 1.5x, /sqli-lab/level2-1.png 2x" data-sizes=auto alt=/sqli-lab/level2-1.png title="admin:admin try" width=572 height=148></p><p>Of course we don&rsquo;t have anything. With the information we have, we can imagine the SQL query:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>username</span><span class=p>,</span><span class=w> </span><span class=n>mail</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=o>=</span><span class=s1>&#39;$username&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>password</span><span class=o>=</span><span class=s1>&#39;$password&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>We can try again with a basic injection <code>' or 1=1;-- -</code>:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level2-2.png data-srcset="/sqli-lab/level2-2.png, /sqli-lab/level2-2.png 1.5x, /sqli-lab/level2-2.png 2x" data-sizes=auto alt=/sqli-lab/level2-2.png title=Output width=601 height=248></p><p>It works fine 😊</p><p>We could also have injected the payload in the password field:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level2-3.png data-srcset="/sqli-lab/level2-3.png, /sqli-lab/level2-3.png 1.5x, /sqli-lab/level2-3.png 2x" data-sizes=auto alt=/sqli-lab/level2-3.png title=Output width=606 height=253></p><h2 id=level-3>Level 3</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level3.png data-srcset="/sqli-lab/level3.png, /sqli-lab/level3.png 1.5x, /sqli-lab/level3.png 2x" data-sizes=auto alt=/sqli-lab/level3.png title="Level 3" width=1287 height=394></p><p>An online shop! We must find what is hidding in there. But first, let&rsquo;s use this product search input:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level3-1.png data-srcset="/sqli-lab/level3-1.png, /sqli-lab/level3-1.png 1.5x, /sqli-lab/level3-1.png 2x" data-sizes=auto alt=/sqli-lab/level3-1.png title=Output width=400 height=285></p><p>Nothing really interesting 😐</p><p>But we see a message on the page: <em>&lsquo;Login is disabled for the moment.&rsquo;</em> what is this? Maybe we could see something in the source code?</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level3-2.png data-srcset="/sqli-lab/level3-2.png, /sqli-lab/level3-2.png 1.5x, /sqli-lab/level3-2.png 2x" data-sizes=auto alt=/sqli-lab/level3-2.png title="Source code" width=1463 height=176></p><p>Bingo! We have an SQL query, but how can we use it? The only solution here is to make an UNION-based SQL injection. Let&rsquo;s try it out:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>level3_users</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Should do the trick. Our payload: <code>' UNION SELECT * FROM leve3_users;-- -</code></p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level3-3.png data-srcset="/sqli-lab/level3-3.png, /sqli-lab/level3-3.png 1.5x, /sqli-lab/level3-3.png 2x" data-sizes=auto alt=/sqli-lab/level3-3.png title=Output width=578 height=313></p><p>Yes it works! We continue to the fourth level.</p><h2 id=level-4>Level 4</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4.png data-srcset="/sqli-lab/level4.png, /sqli-lab/level4.png 1.5x, /sqli-lab/level4.png 2x" data-sizes=auto alt=/sqli-lab/level4.png title="Level 4" width=1223 height=404></p><p><em>This level might be harder than the previous ones for some attackers. And it is normal 😈</em></p><p>The page shows us some buttons we can click to get an article&rsquo;s content:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-1.png data-srcset="/sqli-lab/level4-1.png, /sqli-lab/level4-1.png 1.5x, /sqli-lab/level4-1.png 2x" data-sizes=auto alt=/sqli-lab/level4-1.png title=Output width=500 height=435></p><p>Note the <code>?id=</code> parameter in the URL this could help us in the future.</p><p>Let&rsquo;s see the generated source code:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-2.png data-srcset="/sqli-lab/level4-2.png, /sqli-lab/level4-2.png 1.5x, /sqli-lab/level4-2.png 2x" data-sizes=auto alt=/sqli-lab/level4-2.png title="Source code" width=798 height=436></p><p>How interesting, the server adds a comment containing the article&rsquo;s id right before its content.</p><p>Here we don&rsquo;t have that much information. Our only escape could be &ndash; again &ndash; an UNION-based SQLi. Let&rsquo;s try one:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-3.png data-srcset="/sqli-lab/level4-3.png, /sqli-lab/level4-3.png 1.5x, /sqli-lab/level4-3.png 2x" data-sizes=auto alt=/sqli-lab/level4-3.png title=Output width=654 height=766></p><p>We don&rsquo;t get anything from it, even if we provided an article&rsquo;s id 😕</p><p>The right thing to ask is: why? Why do we get nothing with our payload? Why is the article 3 not even rendered?</p><p>In an UNION query, both SELECT statements <strong>must</strong> return the same number of columns! So maybe we are wrong, maybe there is not two columns in the server&rsquo;s query. We can figure out the server&rsquo;s query:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s1>&#39;$id&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>But how many columns are in there? We can count what we see on the page: the title and the content of the article&mldr; AND the id! Those are three columns. Let&rsquo;s try with three columns:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-4.png data-srcset="/sqli-lab/level4-4.png, /sqli-lab/level4-4.png 1.5x, /sqli-lab/level4-4.png 2x" data-sizes=auto alt=/sqli-lab/level4-4.png title=Output width=660 height=1003></p><p>We now have a second article rendered on the page! We can try to customize our payload to select strings or values:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-5.png data-srcset="/sqli-lab/level4-5.png, /sqli-lab/level4-5.png 1.5x, /sqli-lab/level4-5.png 2x" data-sizes=auto alt=/sqli-lab/level4-5.png title=Output width=909 height=656></p><p>Nice it works as we want! We now want to know the database&rsquo;s name:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-6.png data-srcset="/sqli-lab/level4-6.png, /sqli-lab/level4-6.png 1.5x, /sqli-lab/level4-6.png 2x" data-sizes=auto alt=/sqli-lab/level4-6.png title=Output width=814 height=534></p><p>OK, now we want to know the tables of the database:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-7.png data-srcset="/sqli-lab/level4-7.png, /sqli-lab/level4-7.png 1.5x, /sqli-lab/level4-7.png 2x" data-sizes=auto alt=/sqli-lab/level4-7.png title=Output width=1157 height=536></p><p>Note the <code>limit 1,1</code> at the end, we need it in order to retrieve one by one. Otherwise the UNION query will get an error because we want to SELECT more elements than the first statement.</p><p>Here we get the table <code>COLLATIONS</code>, which is part of the MySQL&rsquo;s server by default. We only want the tables from our database <code>database</code>:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-8.png data-srcset="/sqli-lab/level4-8.png, /sqli-lab/level4-8.png 1.5x, /sqli-lab/level4-8.png 2x" data-sizes=auto alt=/sqli-lab/level4-8.png title=Output width=1423 height=547></p><p>OK now we want to get the columns of this table:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-9.png data-srcset="/sqli-lab/level4-9.png, /sqli-lab/level4-9.png 1.5x, /sqli-lab/level4-9.png 2x" data-sizes=auto alt=/sqli-lab/level4-9.png title=Output width=1455 height=555></p><p>Continuing like this we get the database&rsquo;s schema:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=k>database</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>level4_articles</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=w> </span><span class=nb>int</span><span class=p>,</span><span class=w> </span><span class=n>title</span><span class=w> </span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=w> </span><span class=nb>text</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>level4_users</span><span class=w> </span><span class=p>(</span><span class=n>username</span><span class=w> </span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=nb>text</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level4-10.png data-srcset="/sqli-lab/level4-10.png, /sqli-lab/level4-10.png 1.5x, /sqli-lab/level4-10.png 2x" data-sizes=auto alt=/sqli-lab/level4-10.png title=Output width=1238 height=546></p><h2 id=level-5>Level 5</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5.png data-srcset="/sqli-lab/level5.png, /sqli-lab/level5.png 1.5x, /sqli-lab/level5.png 2x" data-sizes=auto alt=/sqli-lab/level5.png title=Level5 width=1449 height=597></p><p>We want to find the admin&rsquo;s password. Let&rsquo;s try the basic <code>admin:admin</code>:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-1.png data-srcset="/sqli-lab/level5-1.png, /sqli-lab/level5-1.png 1.5x, /sqli-lab/level5-1.png 2x" data-sizes=auto alt=/sqli-lab/level5-1.png title=Output width=944 height=147></p><p>Of course we got a &ldquo;Wrong username/password&rdquo; message. Maybe we can try a basic SQLi?</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-2.png data-srcset="/sqli-lab/level5-2.png, /sqli-lab/level5-2.png 1.5x, /sqli-lab/level5-2.png 2x" data-sizes=auto alt=/sqli-lab/level5-2.png title=Output width=876 height=130></p><p>Nice, the server think we are admin! But the goal here is to find the password, not to log as him.</p><p>We now know that this form is vulnerable to SQL injections, and when we are logged as the admin we have a &ldquo;Welcome admin&rdquo; message. Maybe we can try a blind injection like so:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-3.png data-srcset="/sqli-lab/level5-3.png, /sqli-lab/level5-3.png 1.5x, /sqli-lab/level5-3.png 2x" data-sizes=auto alt=/sqli-lab/level5-3.png title=Output width=915 height=144></p><p>Better! we transformed the query:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>#</span><span class=w> </span><span class=k>From</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=o>=</span><span class=s1>&#39;$username&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>password</span><span class=o>=</span><span class=s1>&#39;$password&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=k>To</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=o>=</span><span class=s1>&#39;admin&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>password</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%&#39;</span><span class=p>;</span><span class=c1>-- -&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>Which can lead us to the admin&rsquo;s password! Let&rsquo;s continue like so:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-4.png data-srcset="/sqli-lab/level5-4.png, /sqli-lab/level5-4.png 1.5x, /sqli-lab/level5-4.png 2x" data-sizes=auto alt=/sqli-lab/level5-4.png title=Output width=1056 height=144></p><p>We now know that the first character of the password is not &ldquo;a&rdquo;. Great! Moving on by changing the letter each time we get the first letter: &ldquo;f&rdquo;</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-5.png data-srcset="/sqli-lab/level5-5.png, /sqli-lab/level5-5.png 1.5x, /sqli-lab/level5-5.png 2x" data-sizes=auto alt=/sqli-lab/level5-5.png title=Output width=1061 height=141></p><p>We now have a method to find the whole password, so I will skip to the end untill the final check:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-6.png data-srcset="/sqli-lab/level5-6.png, /sqli-lab/level5-6.png 1.5x, /sqli-lab/level5-6.png 2x" data-sizes=auto alt=/sqli-lab/level5-6.png title=Output width=1240 height=141></p><p>After this point, no matter what the next character is, we get the &ldquo;Wrong username/password&rdquo; message. This means that we reached the end of the password, let&rsquo;s check it out:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/level5-7.png data-srcset="/sqli-lab/level5-7.png, /sqli-lab/level5-7.png 1.5x, /sqli-lab/level5-7.png 2x" data-sizes=auto alt=/sqli-lab/level5-7.png title=Output width=1244 height=144></p><p>Great! We know the admin&rsquo;s password now. To continue we have to get to the page <code>/f05c8652de134d5c50729fa1b31d355b.php</code>.</p><p>On this page we are redirected to <code>/win.php</code>, meanning we got to the end of the lab.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/sqli-lab/win.png data-srcset="/sqli-lab/win.png, /sqli-lab/win.png 1.5x, /sqli-lab/win.png 2x" data-sizes=auto alt=/sqli-lab/win.png title=Win width=949 height=588></p><p>We just finished the last level of this lab! It was fun, wasn&rsquo;t it?</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://media.giphy.com/media/XreQmk7ETCak0/giphy.gif data-srcset="https://media.giphy.com/media/XreQmk7ETCak0/giphy.gif, https://media.giphy.com/media/XreQmk7ETCak0/giphy.gif 1.5x, https://media.giphy.com/media/XreQmk7ETCak0/giphy.gif 2x" data-sizes=auto alt=https://media.giphy.com/media/XreQmk7ETCak0/giphy.gif title=Congratulations></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-08-20</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/sqli-lab/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://0xninja.fr/sqli-lab/ data-title="SQLi lab solutions" data-via=0x_Ninja data-hashtags=article,ctf,sqli,writeup><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://0xninja.fr/sqli-lab/ data-hashtag=article><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://0xninja.fr/sqli-lab/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://0xninja.fr/sqli-lab/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/article/>article</a>,&nbsp;<a href=/tags/ctf/>ctf</a>,&nbsp;<a href=/tags/sqli/>sqli</a>,&nbsp;<a href=/tags/writeup/>writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/htb-magic/ class=prev rel=prev title="📦 HTB - Magic"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>📦 HTB - Magic</a>
<a href=/htb-ready/ class=next rel=next title="📦 HTB - Ready">📦 HTB - Ready<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.114.1">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://0xninja.fr target=_blank>0xNinja</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"0xNinja","id-2":"0xNinja"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1500,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:5e3,speed:150}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>